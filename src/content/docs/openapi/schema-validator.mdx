---
title: OpenAPI Spec
description: A detailed reference guide on validating embedded OpenAPI contracts in your Starlight docs site with EinarCLI.
---

EinarCLI allows you to validate embedded OpenAPI contracts. It provides the flexibility to create the contract within your project and immediately validate it against the OpenAPI specification. This ensures that your API definitions are always up to standard, making it easier to maintain consistency and reliability throughout the development lifecycle.

## üõ†Ô∏è Generate a New Embedded Spec

Inside your project directory, run the following command to create a new Embedded Spec:

```sh
einar generate openapi create-customer-spec
```

The create-customer-spec will be created in the following directory structure:

```sh
/app
  /shared
    /openapi
      - create_customer_spec_test.go
      - create_customer_spec.go
      - create_customer_spec.json
```

Here's an example of how the generated code will look:
```sh
type CreateCustomerSpec struct {
	APIReferenceHTML string
	HelloEndpoint    *contract.Endpoint
	GreetEndpoint    *contract.Endpoint
}

//go:embed create_customer_spec.json
var create_customer_spec []byte

func init() {
	ioc.Registry(NewCreateCustomerSpec)
}

func NewCreateCustomerSpec() (CreateCustomerSpec, error) {
	apiReferenceHTML, err := scalar.ApiReferenceHTML(&scalar.Options{
		SpecContent: string(create_customer_spec),
	})
	if err != nil {
		return CreateCustomerSpec{}, err
	}
	helloEndpoint, err := contract.LoadSpecEndpoint(
		contract.EndpointDetails{
			ContractData: create_customer_spec, 
			Path:         "/hello",
			HTTPMethod:   "POST",
			ContentType:  "application/json",
		},
	)
	if err != nil {
		return CreateCustomerSpec{}, err
	}
	greetEndpoint, err := contract.LoadSpecEndpoint(
		contract.EndpointDetails{
			ContractData: create_customer_spec,
			Path:         "/greet",
			HTTPMethod:   "POST",
			ContentType:  "application/json",
		},
	)
	if err != nil {
		return CreateCustomerSpec{}, err
	}
	return CreateCustomerSpec{
		APIReferenceHTML: apiReferenceHTML,
		HelloEndpoint:    helloEndpoint,
		GreetEndpoint:    greetEndpoint}, nil
}
```

## üë®‚Äçüíª Tutorial: How to Generate Spec Docs
Here‚Äôs an example of how to use the generated spec in an HTTP server GET request to serve spec documentation:

1.- Install the HTTP server if not installed:
```sh
einar install labstack-echo
```

2.- Generate your custom GET controller to serve your spec documentation:
```sh
einar generate get-controller serve-docs
```
The generated controller will look like:
```go
func init() {
	ioc.Registry(serveDocs, serverwrapper.NewEchoWrapper)
}
func serveDocs(e serverwrapper.EchoWrapper) {
	e.GET("/insert-your-custom-pattern-here", func(c echo.Context) error {
		return c.JSON(http.StatusOK, map[string]string{
			"message": "Unimplemented",
		})
	})
}
```
3.- Inject your spec using EinarIOC and serve it as HTML:
```go
func init() {
	ioc.Registry(serveDocs,
		serverwrapper.NewEchoWrapper,
		openapi.NewCreateCustomerSpec)
}
func serveDocs(
	e serverwrapper.EchoWrapper,
	spec openapi.CreateCustomerSpec) {
	e.GET("/docs", func(c echo.Context) error {
		return c.HTML(http.StatusOK, spec.APIReferenceHTML)
	})
}
```
4.- Run your app by executing `go run main.go`, and open http://localhost:8080/docs in your browser. You will see the following:

![Descripci√≥n de la imagen](../../../assets/spec.jpeg)
